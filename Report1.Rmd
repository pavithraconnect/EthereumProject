---
title: "Project 1 - Binance Coin Study"
author: 

- "Pavithra Kamalakannan Ushakannan 

output: html_document
---

<br>  

# Token Selection

The **Ethereum Project** and thereby our dataset consists of several tokens. Among the tokens, the token that we will be working on is **[Binance Coin (BNB)](https://www.binance.com/en)**.

# Data Description

The data file _networkbnbTX.txt_ consists of four fields as below.  

1. Seller User ID 
2. Buyer User ID
3. Unix Timestamp
4. Amount (in sub-units)

# Preprocessing

Upon studying the binance coin on [etherscan.io](etherscan.io), the following information were collected -  

* The sub-units of a binance token is **$10^{18}$**.  
* The total supply of binance tokens are **192,443,301 BNB**.  
* Hence the total sub-units supply of the binance tokens are
```{r}
total_supply <- 10^18 * 192443301
print(paste(head(total_supply)))
```

### Identifying Outliers

To define outlier for the problem, any transaction whose amount is greater than the total supply of sub-units are considered to be outliers.

The following code detects if there exists at least one outlier transaction by checking the maximum amount of all the transaction exceeds the total supply.

```{r}
working_dir <- getwd()
binanceTokenGraph <- read.table("networkbnbTX.txt", header = FALSE)
names(binanceTokenGraph)<-c("SellerID","ReceiverID","TimeStamp","Amount")
print(total_supply < max(binanceTokenGraph$Amount))

binanceTokenGraphDF <- as.data.frame(binanceTokenGraph)
outliers <- binanceTokenGraphDF[binanceTokenGraphDF$Amount > total_supply]
print(length(outliers))
```

Since there is no exorbitant transaction, it is safe to declare that the data **does not** contain any outlier.

# Analysis

**Question - Find the distribution of how many times a user 1 - buys, 2 - sells a token. Which discrete distribution type fits these distributions best? Estimate distribution parameters.**

### Number of times an user sells tokens

```{r}
#---------- Number of sales ---------
countOfSeller<-table(binanceTokenGraph$SellerID) # gives the frequency at which users sells tokens
frequencyDataFrame<-as.data.frame(countOfSeller)
colnames(frequencyDataFrame)<-c("SellerID","Count")
countOfCount<-table(frequencyDataFrame$Count) # gives the number of users who have made 'x' sales.
frequencyDataFrame2<-as.data.frame(countOfCount)
colnames(frequencyDataFrame2)<-c("Token Count Sold","Number of Users")
print(frequencyDataFrame2)
meanOfDistribution <- mean(frequencyDataFrame2$`Number of Users`)
print(meanOfDistribution)
varianceOfDistibution<-var(frequencyDataFrame2$`Number of Users`)
print(varianceOfDistibution)
```

The mean frequency of number of sales `r meanOfDistribution` and variance is `r varianceOfDistibution`

```{r}
#-------- Plotting 100% of the data ----------
attach(frequencyDataFrame2)
plot(y=frequencyDataFrame2$`Number of Users`, 
     x=frequencyDataFrame2$`Token Count Sold`, 
     ylab="Number of Users", 
     xlab="No of times a token was sold",
     main="Number of times user sells token",
     type="o")
```


From the graph, and the data used by the graph, we see that 16575 users have made single transaction. The next higher frequency transaction - 2 - is done by 1981 users. i.e. more than 99% of the users have made less than 6 transactions each.  

The trend clearly shows that lesser users make higher number of transactions. The resulting graph is too crowded on the lower end of the x-axis (number of users who made 'x' sales).  To get a clearer picture of the crowded portion, and hence to make it easier to find the distribution, we trim the last 99% of the data, thereby eliminating seemingly outlier data.

```{r}
#Removing 99% of the data and plotting the trimmed data.
plot(y=frequencyDataFrame2$`Number of Users`, 
     x=frequencyDataFrame2$`Token Count Sold`,  
     ylab="Number of Users", 
     xlab="No of times a token was sold",
     main="Number of times user sells token",
     ylim = c(0,165.75),
     type="o")
```

Now, the data that we have must be fitted to Exponential, Poissson, Negative Binomial, Weibull distributions and determine the distribution that the data fits more accurately.

```{r}
#install.packages("fitdistrplus")
library(fitdistrplus)
exp <- fitdistr(frequencyDataFrame2$`Number of Users`, densfun = "exponential")
exp
```

```{r}
negBin <- fitdistr(frequencyDataFrame2$`Number of Users`, densfun = "negative binomial")
negBin
```

```{r}
poisson <- fitdistr(frequencyDataFrame2$`Number of Users`, densfun = "poisson")
poisson
```

```{r}
weibull <- fitdistr(frequencyDataFrame2$`Number of Users`, densfun = "weibull")
weibull
```

**Conclusion**:


Number of times user sells a token follows a negative binomial distribution with mean of `r meanOfDistribution` and a variance of `r varianceOfDistibution`.

### Number of times an user purchases tokens

```{r}
#---------- Number of purchases ---------
countOfBuyer<-table(binanceTokenGraph$ReceiverID)
freqDataFrame<-as.data.frame(countOfBuyer)
colnames(freqDataFrame)<-c("ReceiverID","Frequency")
countOfFrequency<-table(freqDataFrame$Frequency)
freqDataFrame2<-as.data.frame(countOfFrequency)
colnames(freqDataFrame2)<-c("Token Count Bought","Number of Users")
print(freqDataFrame2)
meanOfDistribution2 <- mean(freqDataFrame2$`Number of Users`)
print(meanOfDistribution2)
varianceOfDistibution2<-var(freqDataFrame2$`Number of Users`)
print(varianceOfDistibution2)
```


The mean frequency of number of sales `r meanOfDistribution2` and variance is `r varianceOfDistibution2`


```{r}
#---------Plotting 100% of the data---------
attach(freqDataFrame2)
plot(y=freqDataFrame2$`Number of Users`, 
     x=freqDataFrame2$`Token Count Bought`, 
     ylab="Number of Users", 
     xlab="No of times a token was bought",
     main="Number of times user buys token",
     type="o")
```


From the graph, and the data used by the graph, we see that 252994 users have made single purchase. The next higher frequency purchase - 2 - is done by 28353 users. 

The trend again shows that lesser number of users make higher number of purchases. The resulting graph is too crowded on the lower end of the x-axis (number of users who made 'x' purchases). To get a clearer picture of the crowded portion, and hence to make it easier to find the distribution, we trim the last 99% of the data, thereby eliminating seemingly outlier data.

```{r}
#Removing 99% of the data and plotting the trimmed data.
plot(type="l", 
     y=freqDataFrame2$`Number of Users`, 
     x=freqDataFrame2$`Token Count Bought`, 
     ylab="Number of Users", 
     xlab="No of times a token was bought",
     main="Number of times user buys token",
     ylim = c(0,2600))
```


Now, the data that we have must be fitted to Exponential, Poissson, Negative Binomial, Weibull distributions and determine the distribution that the data fits more accurately.

```{r}
#install.packages("fitdistrplus")
library(fitdistrplus)
exp <- fitdistr(freqDataFrame2$`Number of Users`, densfun = "exponential")
exp
```

```{r}
negBin <- fitdistr(freqDataFrame2$`Number of Users`, densfun = "negative binomial")
negBin
```

```{r}
poisson <- fitdistr(freqDataFrame2$`Number of Users`, densfun = "poisson")
poisson
```

```{r}
weibull <- fitdistr(freqDataFrame2$`Number of Users`, densfun = "weibull")
weibull
```

**Conclusion**:

Number of times user buys a token follows a negative binomial distribution with mean of `r meanOfDistribution2` and a variance of `r varianceOfDistibution2`.
